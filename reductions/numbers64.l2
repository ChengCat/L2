(** Turns a 8-byte integer into base-2 s-expression representation of it.
(function binary->base2sexpr (binary)
	[lst [lst [-b-] [nil]] [lst (with return
		{(continuation write (count in out)
			(if $count
				{write [- $count (b 0000000000000000000000000000000000000000000000000000000000000001)]
					[>> $in (b 0000000000000000000000000000000000000000000000000000000000000001)]
					[lst (if [and $in (b 0000000000000000000000000000000000000000000000000000000000000001)] [-1-] [-0-]) $out]}
				{return $out})) (b 0000000000000000000000000000000000000000000000000000000001000000) $binary [nil]}) [nil]]]))

(function & (l)
	[binary->base2sexpr
		(** Turns the base-10 s-expression input into a 8-byte integer.
			(with return {(continuation read (in out)
				(if [sexpr= $in [nil]]
					{return $out}
					{read [rst $in] [+ [* $out (b 0000000000000000000000000000000000000000000000000000000000001010)]
						(if [sexpr= [fst $in] [-9-]] (b 0000000000000000000000000000000000000000000000000000000000001001)
						(if [sexpr= [fst $in] [-8-]] (b 0000000000000000000000000000000000000000000000000000000000001000)
						(if [sexpr= [fst $in] [-7-]] (b 0000000000000000000000000000000000000000000000000000000000000111)
						(if [sexpr= [fst $in] [-6-]] (b 0000000000000000000000000000000000000000000000000000000000000110)
						(if [sexpr= [fst $in] [-5-]] (b 0000000000000000000000000000000000000000000000000000000000000101)
						(if [sexpr= [fst $in] [-4-]] (b 0000000000000000000000000000000000000000000000000000000000000100)
						(if [sexpr= [fst $in] [-3-]] (b 0000000000000000000000000000000000000000000000000000000000000011)
						(if [sexpr= [fst $in] [-2-]] (b 0000000000000000000000000000000000000000000000000000000000000010)
						(if [sexpr= [fst $in] [-1-]] (b 0000000000000000000000000000000000000000000000000000000000000001)
							(b 0000000000000000000000000000000000000000000000000000000000000000))))))))))]}))
				[fst $l] (b 0000000000000000000000000000000000000000000000000000000000000000)}))])
