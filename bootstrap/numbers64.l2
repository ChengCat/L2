(++ Turns an 8-byte integer into base-2 s-expression representation of it.)

(function binary->base2sexpr (binary r)
	[lst [lllllllst [-l- $r][-i- $r][-t- $r][-e- $r][-r- $r][-a- $r][-l- $r][nil $r] $r]
		[lst (with return {(continuation write (count in out)
				(if $count
					{write [- $count (literal 0000000000000000000000000000000000000000000000000000000000000001)]
						[>> $in (literal 0000000000000000000000000000000000000000000000000000000000000001)]
						[lst (if [and $in (literal 0000000000000000000000000000000000000000000000000000000000000001)]
							[-1- $r] [-0- $r]) $out $r]}
					{return $out}))
				(literal 0000000000000000000000000000000000000000000000000000000001000000) $binary [nil $r]})
			[nil $r]$r]$r])


(function & (l r)
	[binary->base2sexpr
		(** Turns the base-10 s-expression input into a 8-byte integer.
			(with return {(continuation read (in out)
				(if [nil? $in]
					{return $out}
					{read [rst $in] [+ [* $out (literal 0000000000000000000000000000000000000000000000000000000000001010)]
						(if [char= [fst $in] [-9- $r]] (literal 0000000000000000000000000000000000000000000000000000000000001001)
						(if [char= [fst $in] [-8- $r]] (literal 0000000000000000000000000000000000000000000000000000000000001000)
						(if [char= [fst $in] [-7- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000111)
						(if [char= [fst $in] [-6- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000110)
						(if [char= [fst $in] [-5- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000101)
						(if [char= [fst $in] [-4- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000100)
						(if [char= [fst $in] [-3- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000011)
						(if [char= [fst $in] [-2- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000010)
						(if [char= [fst $in] [-1- $r]] (literal 0000000000000000000000000000000000000000000000000000000000000001)
							(literal 0000000000000000000000000000000000000000000000000000000000000000))))))))))]}))
				[fst $l] (literal 0000000000000000000000000000000000000000000000000000000000000000)})) $r])
