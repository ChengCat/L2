(** Turns a 8-byte integer into base-2 s-expression representation of it.
(function binary->base2sexpr (binary)
	[lst [lllllllst [-l-][-i-][-t-][-e-][-r-][-a-][-l-][nil]] [lst (with return
		{(continuation write (count in out)
			(if $count
				{write [- $count (literal 0000000000000000000000000000000000000000000000000000000000000001)]
					[>> $in (literal 0000000000000000000000000000000000000000000000000000000000000001)]
					[lst (if [and $in (literal 0000000000000000000000000000000000000000000000000000000000000001)] [-1-] [-0-]) $out]}
				{return $out})) (literal 0000000000000000000000000000000000000000000000000000000001000000) $binary [nil]}) [nil]]]))

(function & (l)
	[binary->base2sexpr
		(** Turns the base-10 s-expression input into a 8-byte integer.
			(with return {(continuation read (in out)
				(if [nil? $in]
					{return $out}
					{read [rst $in] [+ [* $out (literal 0000000000000000000000000000000000000000000000000000000000001010)]
						(if [char= [fst $in] [-9-]] (literal 0000000000000000000000000000000000000000000000000000000000001001)
						(if [char= [fst $in] [-8-]] (literal 0000000000000000000000000000000000000000000000000000000000001000)
						(if [char= [fst $in] [-7-]] (literal 0000000000000000000000000000000000000000000000000000000000000111)
						(if [char= [fst $in] [-6-]] (literal 0000000000000000000000000000000000000000000000000000000000000110)
						(if [char= [fst $in] [-5-]] (literal 0000000000000000000000000000000000000000000000000000000000000101)
						(if [char= [fst $in] [-4-]] (literal 0000000000000000000000000000000000000000000000000000000000000100)
						(if [char= [fst $in] [-3-]] (literal 0000000000000000000000000000000000000000000000000000000000000011)
						(if [char= [fst $in] [-2-]] (literal 0000000000000000000000000000000000000000000000000000000000000010)
						(if [char= [fst $in] [-1-]] (literal 0000000000000000000000000000000000000000000000000000000000000001)
							(literal 0000000000000000000000000000000000000000000000000000000000000000))))))))))]}))
				[fst $l] (literal 0000000000000000000000000000000000000000000000000000000000000000)}))])
